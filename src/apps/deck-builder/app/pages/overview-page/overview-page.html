<div class="deck-pane">
	<div class="heading">
		<h1>{{deckName() || 'New deck'}}</h1>
		<span>{{totalCardQuantity()}} cards in deck</span>
	</div>
	<div class="deck-actions">
		@if(existingDeck()) {
		<button (click)="updateCollectionCardDeck()">Save</button>
		}
		@else {
		<button (click)="addCollectionCardDeck()">Save</button>
		}
		<button (click)="openLoadDeckDialog()">Load deck</button>
		<button [disabled]="!existingDeck()" (click)="addCollectionCardDeck()">Create copy</button>
		<button (click)="reset()">Reset</button>
		<button [disabled]="!existingDeck()" (click)="deleteCollectionCardDeck()">Delete</button>
		<button (click)="openLimitlessDeckBuilder()">Share</button>
	</div>
	<div class="deck-cards">
		@for(card of deckCards(); track card.id) {
		<tcg-card (click)="openCardDetail(card)" [quantity]="card.quantity" class="deck-card"
			[style.--background-image-url]="`url(${card.image}/low.webp)`"></tcg-card>
		}
	</div>
</div>
<div class="collection-pane">
	<div class="collection-actions">
		<search>
			<input type="search" [field]="searchForm" placeholder="Search name">
		</search>

		<label for="in-rotation-filter">
			<input id="in-rotation-filter" type="checkbox" [field]="inRotationFilterForm">
			In rotation
		</label>

		<div>
			<label for="pokemon-type-filter" [style.--md-comp-outlined-text-field-label-text-background-color]="'var(--md-sys-color-surface-container)'">Pokemon Type</label>
			<select id="pokemon-type-filter" [field]="pokemonTypeFilterForm">
				<option value="All">All</option>
				@for (pokemonType of POKEMON_TYPES; track pokemonType) {
				<option [value]="pokemonType">{{pokemonType}}</option>
				}
			</select>
		</div>

		<button>Fullscreen</button>
	</div>
	<div class="collection-cards">
		@for(card of sortedTcgDexCollectionCards(); track card.id) {
		<tcg-card (click)="openCardDetail(card)" [quantity]="getQuantitySum(card.variants)"
			[style.--background-image-url]="`url(${card.image}/low.webp)`"></tcg-card>
		}
	</div>
</div>
@let detailCard = selectedDeckCard();
<dialog #cardDetail closedby="any">
	<div class="detail">
		@if(detailCard) {
		@let deckQuantity = detailCard.quantity;
		@let collectionQuantity = getQuantitySum(detailCard.variants);
		<tcg-card (click)="closeCardDetail()" class="detail-card"
			[style.--background-image-url]="`url(${detailCard.image}/high.webp)`"></tcg-card>
		<div class="detail-actions">
			<button (click)="removeCard(detailCard)" [disabled]="deckQuantity === 0">-</button>
			<span>{{deckQuantity.toString().padStart(2,
				"0")}}/{{collectionQuantity.toString().padStart(2, "0")}}</span>
			<button (click)="addCard(detailCard)" [disabled]="deckQuantity === collectionQuantity">+</button>
		</div>
		}
	</div>
</dialog>
<dialog #loadDeckDialog closedby="any">
	<div class="load-deck">
		<h2 class="md-typescale-headline-small">Load deck</h2>
		<div>
			<label for="load-deck">Deck</label>
			<select class="load-deck-select" id="load-deck" [field]="loadDeckForm">
				@for (collectionDeck of sortedCollectionDecks(); track collectionDeck._id) {
				<option [value]="collectionDeck._id">{{collectionDeck.name}}</option>
				}
			</select>
		</div>
		<div class="load-deck-actions">
			<button (click)="closeLoadDeckDialog()">Cancel</button>
			<button (click)="loadDeck()" [disabled]="loadDeckForm().invalid()">Load</button>
		</div>
	</div>
</dialog>
